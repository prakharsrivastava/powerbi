import org.apache.spark.sql.{SparkSession, Row}
import org.apache.spark.sql.types.{StructType, StructField, TimestampType}

object TimestampDataFrameExample {
  def main(args: Array[String]): Unit = {
    // Create Spark session
    val spark = SparkSession.builder()
      .appName("TimestampDataFrameExample")
      .master("local[*]")
      .getOrCreate()

    // Sample data with a timestamp column
    val data = Seq(
      Row(1, "John", java.sql.Timestamp.valueOf("2024-01-11 12:30:00")),
      Row(2, "Jane", java.sql.Timestamp.valueOf("2024-01-11 13:45:00")),
      Row(3, "Bob", java.sql.Timestamp.valueOf("2024-01-11 15:00:00"))
    )

    // Define the schema with a timestamp column
    val schema = StructType(
      Seq(
        StructField("id", IntegerType, true),
        StructField("name", StringType, true),
        StructField("timestamp_column", TimestampType, true)
      )
    )

    // Create DataFrame
    val df = spark.createDataFrame(spark.sparkContext.parallelize(data), schema)

    // Show the DataFrame
    df.show()

    // Stop Spark session
    spark.stop()
  }
}
