 val parseCsvToArray = udf((csv: String) => {
    csv.split(", ").map { pair =>
      val Array(key, value) = pair.split(":")
      Row(key, value)
    }
  }, ArrayType(targetArraySchema)). 
