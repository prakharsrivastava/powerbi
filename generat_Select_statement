import org.apache.spark.sql.functions._

object ConvertToJsonString extends App {
  // Sample data with key-value pairs
  val data = Seq(
    ("color", "black"),
    ("gift", "no")
  )

  // Convert each pair into a JSON object string
  val jsonStrings = data.map { case (key, value) =>
    s"""{"label":"$key", "value":"$value"}"""
  }

  // Join the JSON strings with commas and enclose them in square brackets to form an array
  val jsonArrayString = "[" + jsonStrings.mkString(", ") + "]"

  println(jsonArrayString)
}
