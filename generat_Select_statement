def removeArrayType(schema: StructType): StructType = {
  val newFields = schema.fields.filterNot(_.dataType.isInstanceOf[ArrayType])
  StructType(newFields)
}

val newSchema = removeArrayType(originalSchema)
